<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebSocket</title>
    <style>
        body {
            font-family: sans-serif; padding: 20px; background: #121212; color: #ffff;
        }
        #log { background: #000; padding: 10px; height: 300px; overflow-y:
                scroll; border: 1px solid #333}
        .status-on {color: #32ffc3
        }
        .status-off {color: #ff6d6d
        }
    </style>
</head>
<body>
<h1>Rhodie Websocket</h1>
<p id="status" class="status-off">Connecting...</p>
<form id="message-form">
    <input id="message-input" type="text"
    placeholder="Send Cargo..." required>
    <button type="submit">Deploy Message</button>
</form>
<h3>Live Stream Logs</h3>
<pre id="log"></pre>

</body>
<script>
    const StatusEL = document.getElementById("status");
    const log = document.getElementById("log");
    const input = document.getElementById("message-input");

    //1. initiate websocket connection
    const socket = new WebSocket('ws://localhost:8080');

    const appendLog = (label, message) => {
        const entry = `${new Date().toLocaleTimeString()}
        ${label} ${message}\n`
           log.textContent = entry + log.textContent;
    }

    socket.addEventListener('open', ()=> {
        StatusEL.textContent = "Connected: ws://localhost:8080"
        StatusEL.className = "status-on";
        appendLog("[SYSTEM]", "tunnel established.")
    });

    socket.addEventListener('close', ()=> {
        StatusEL.textContent = "Disconnected"
        StatusEL.className = "status-off";
        appendLog("[SYSTEM]", "Tunnel Collapsed.");
    });

    socket.addEventListener('message', (e) => {
        appendLog("RECEIVED", e.data);
    })

    document.getElementById("message-form").addEventListener('submit', (e)=> {
        e.preventDefault();

        if(socket.readyState !== WebSocket.OPEN) {
            appendLog('[ERROR]', "No active tunnel found");
        }

        const msg = input.value.trim();
        socket.send(msg);
        appendLog("[SENT]", msg);
        input.value = "";
    })





</script>
</html>